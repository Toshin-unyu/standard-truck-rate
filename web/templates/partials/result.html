{{define "result"}}
<div class="space-y-6">
    <!-- ランキング表示 -->
    <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-lg font-semibold text-gray-700 mb-4">運賃比較ランキング</h2>
        <div class="space-y-2">
            {{range .Rankings}}
            <div class="flex items-center justify-between p-3 rounded-md {{if eq .Rank 1}}bg-green-50 border-2 border-green-500{{else}}bg-gray-50{{end}}">
                <div class="flex items-center gap-3">
                    <span class="flex items-center justify-center w-8 h-8 rounded-full {{if eq .Rank 1}}bg-green-500 text-white{{else if eq .Rank 2}}bg-gray-400 text-white{{else if eq .Rank 3}}bg-amber-600 text-white{{else}}bg-gray-300 text-gray-700{{end}} font-bold text-sm">
                        {{.Rank}}
                    </span>
                    <span class="font-medium {{if eq .Rank 1}}text-green-700{{else}}text-gray-700{{end}}">{{.Type}}</span>
                    {{if eq .Rank 1}}
                    <span class="px-2 py-1 bg-green-500 text-white text-xs rounded-full">最安</span>
                    {{end}}
                </div>
                <span class="text-xl font-bold {{if eq .Rank 1}}text-green-700{{else}}text-gray-800{{end}}">&yen;{{formatNumber .Fare}}</span>
            </div>
            {{end}}
        </div>
    </div>

    <!-- 詳細表示（アコーディオン） -->
    <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-lg font-semibold text-gray-700 mb-4">計算詳細</h2>

        <!-- 距離制運賃 -->
        <details class="mb-4 border rounded-md">
            <summary class="p-4 cursor-pointer bg-gray-50 hover:bg-gray-100 font-medium">
                距離制運賃（トラ協基準）: &yen;{{formatNumber .DistanceFareResult.TotalFare}}
            </summary>
            <div class="p-4 text-sm space-y-1 border-t">
                <p>運輸局: {{regionName .DistanceFareResult.RegionCode}}</p>
                <p>車格: {{vehicleName .DistanceFareResult.VehicleCode}}</p>
                <p>経路距離: {{.DistanceFareResult.DistanceKm}}km → 運賃計算距離: {{.DistanceFareResult.RoundedKm}}km</p>
                <p>基本運賃: &yen;{{formatNumber .DistanceFareResult.BaseFare}}</p>
                {{if .DistanceFareResult.IsNight}}
                <p class="text-purple-600">深夜割増: +&yen;{{formatNumber .DistanceFareResult.NightSurcharge}}（30%増）</p>
                {{end}}
                {{if .DistanceFareResult.IsHoliday}}
                <p class="text-orange-600">休日割増: +&yen;{{formatNumber .DistanceFareResult.HolidaySurcharge}}（20%増）</p>
                {{end}}
                <p class="font-bold pt-2 border-t mt-2">合計: &yen;{{formatNumber .DistanceFareResult.TotalFare}}</p>
            </div>
        </details>

        <!-- 時間制運賃 -->
        <details class="mb-4 border rounded-md">
            <summary class="p-4 cursor-pointer bg-gray-50 hover:bg-gray-100 font-medium">
                時間制運賃（トラ協基準）: &yen;{{formatNumber .TimeFareResult.TotalFare}}
            </summary>
            <div class="p-4 text-sm space-y-1 border-t">
                <p>運輸局: {{regionName .TimeFareResult.RegionCode}}</p>
                <p>車格: {{vehicleName .TimeFareResult.VehicleCode}}</p>
                <p>時間制区分: {{.TimeFareResult.Hours}}時間制</p>
                <p>走行距離: {{.TimeFareResult.DistanceKm}}km（基礎キロ: {{.TimeFareResult.BaseKm}}km）</p>
                <p>拘束時間: {{.TimeFareResult.TotalMinutes}}分（{{formatDuration .TimeFareResult.TotalMinutes}}）</p>
                <p>基礎運賃: &yen;{{formatNumber .TimeFareResult.BaseFare}}</p>
                {{if gt .TimeFareResult.DistanceSurcharge 0}}
                <p>距離加算: +&yen;{{formatNumber .TimeFareResult.DistanceSurcharge}}（超過{{.TimeFareResult.ExcessKm}}km）</p>
                {{end}}
                {{if gt .TimeFareResult.TimeSurcharge 0}}
                <p>時間加算: +&yen;{{formatNumber .TimeFareResult.TimeSurcharge}}（超過{{.TimeFareResult.ExcessMinutes}}分）</p>
                {{end}}
                {{if .TimeFareResult.IsNight}}
                <p class="text-purple-600">深夜割増: +&yen;{{formatNumber .TimeFareResult.NightSurcharge}}（30%増）</p>
                {{end}}
                {{if .TimeFareResult.IsHoliday}}
                <p class="text-orange-600">休日割増: +&yen;{{formatNumber .TimeFareResult.HolidaySurcharge}}（20%増）</p>
                {{end}}
                <p class="font-bold pt-2 border-t mt-2">合計: &yen;{{formatNumber .TimeFareResult.TotalFare}}</p>
            </div>
        </details>

        <!-- 赤帽（距離制） -->
        <details class="mb-4 border rounded-md">
            <summary class="p-4 cursor-pointer bg-gray-50 hover:bg-gray-100 font-medium">
                赤帽運賃（距離制）: &yen;{{formatNumber .AkabouDistanceResult.TotalFare}}
            </summary>
            <div class="p-4 text-sm space-y-1 border-t">
                <p>距離: {{.AkabouDistanceResult.DistanceKm}}km</p>
                <p>基本料金: &yen;{{formatNumber .AkabouDistanceResult.BaseFare}}（20km以内）</p>
                {{if gt .AkabouDistanceResult.DistanceCharge 0}}
                <p>距離加算: +&yen;{{formatNumber .AkabouDistanceResult.DistanceCharge}}</p>
                {{end}}
                {{if gt .AkabouDistanceResult.AreaSurcharge 0}}
                <p class="text-blue-600">地区割増（{{.AkabouDistanceResult.Area}}）: +&yen;{{formatNumber .AkabouDistanceResult.AreaSurcharge}}</p>
                {{end}}
                {{if .AkabouDistanceResult.IsNight}}
                <p class="text-purple-600">深夜割増: +&yen;{{formatNumber .AkabouDistanceResult.NightSurcharge}}（30%増）</p>
                {{end}}
                {{if .AkabouDistanceResult.IsHoliday}}
                <p class="text-orange-600">休日割増: +&yen;{{formatNumber .AkabouDistanceResult.HolidaySurcharge}}（20%増）</p>
                {{end}}
                <p class="font-bold pt-2 border-t mt-2">合計: &yen;{{formatNumber .AkabouDistanceResult.TotalFare}}</p>
            </div>
        </details>

        <!-- 赤帽（時間制） -->
        <details class="border rounded-md">
            <summary class="p-4 cursor-pointer bg-gray-50 hover:bg-gray-100 font-medium">
                赤帽運賃（時間制）: &yen;{{formatNumber .AkabouTimeResult.TotalFare}}
            </summary>
            <div class="p-4 text-sm space-y-1 border-t">
                <p>作業時間: {{.AkabouTimeResult.DurationMin}}分（{{formatDuration .AkabouTimeResult.DurationMin}}）</p>
                <p>基本料金: &yen;{{formatNumber .AkabouTimeResult.BaseFare}}（2時間まで）</p>
                {{if gt .AkabouTimeResult.OvertimeCharge 0}}
                <p>超過料金: +&yen;{{formatNumber .AkabouTimeResult.OvertimeCharge}}（{{.AkabouTimeResult.OvertimeMin}}分超過）</p>
                {{end}}
                {{if gt .AkabouTimeResult.AreaSurcharge 0}}
                <p class="text-blue-600">地区割増（{{.AkabouTimeResult.Area}}）: +&yen;{{formatNumber .AkabouTimeResult.AreaSurcharge}}</p>
                {{end}}
                {{if .AkabouTimeResult.IsNight}}
                <p class="text-purple-600">深夜割増: +&yen;{{formatNumber .AkabouTimeResult.NightSurcharge}}（30%増）</p>
                {{end}}
                {{if .AkabouTimeResult.IsHoliday}}
                <p class="text-orange-600">休日割増: +&yen;{{formatNumber .AkabouTimeResult.HolidaySurcharge}}（20%増）</p>
                {{end}}
                <p class="font-bold pt-2 border-t mt-2">合計: &yen;{{formatNumber .AkabouTimeResult.TotalFare}}</p>
            </div>
        </details>
    </div>

    <!-- 注意事項 -->
    <div class="bg-yellow-50 border border-yellow-200 rounded-md p-4 text-sm text-yellow-800">
        <p class="font-medium mb-1">ご注意</p>
        <p>この運賃計算はあくまで目安です。実際の運賃は運送事業者との契約内容によって異なります。</p>
    </div>
</div>
{{end}}

{{define "error"}}
<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md">
    <p class="font-medium">エラー</p>
    <p>{{.Error}}</p>
</div>
{{end}}
