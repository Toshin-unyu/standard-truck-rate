{{define "result"}}
<div class="space-y-6">
    <!-- è‡ªå‹•å–å¾—æƒ…å ± -->
    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
        <h3 class="text-base font-medium text-blue-800 mb-2">ğŸ” è‡ªå‹•å–å¾—æƒ…å ±</h3>
        <div class="flex flex-wrap gap-x-6 gap-y-1 text-sm text-blue-700">
            {{if eq .VehicleCode 0}}
            <!-- è»½è²¨ç‰©ã®å ´åˆ -->
            <span>è»Šæ ¼: <strong>è»½è²¨ç‰©/èµ¤å¸½</strong></span>
            <span>è·é›¢: <strong>{{.AkabouDistanceResult.DistanceKm}}km</strong></span>
            <span>èµ°è¡Œæ™‚é–“: <strong>{{formatDuration .DrivingMinutes}}</strong></span>
            {{if .AkabouDistanceResult.Area}}
            <span>åœ°åŒº: <strong>{{.AkabouDistanceResult.Area}}</strong></span>
            {{end}}
            {{else}}
            <!-- 2tä»¥ä¸Šã®å ´åˆ -->
            <span>é‹è¼¸å±€: <strong>{{regionName .DistanceFareResult.RegionCode}}</strong></span>
            <span>è·é›¢: <strong>{{.DistanceFareResult.DistanceKm}}km</strong></span>
            <span>èµ°è¡Œæ™‚é–“: <strong>{{formatDuration .TimeFareResult.DrivingMinutes}}</strong></span>
            {{end}}
        </div>
    </div>

    <!-- é‹è³ƒæ¯”è¼ƒï¼ˆæ¨ªä¸¦ã³ã‚«ãƒ©ãƒ ï¼‰ -->
    <div class="bg-white rounded-lg border border-gray-200 p-6">
        <h2 class="text-base font-semibold text-gray-800 mb-5">é‹è³ƒæ¯”è¼ƒ</h2>

        {{/* æœ€å®‰å€¤ã‚’å–å¾—ï¼ˆRankings[0]ãŒæœ€å®‰ï¼‰ */}}
        {{$minFare := (index .Rankings 0).Fare}}

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            {{range .Rankings}}
            <div class="relative p-5 rounded-lg border-2 transition-all {{if eq .Rank 1}}border-green-500 bg-green-50{{else}}border-gray-200 bg-gray-50 hover:border-gray-300{{end}}">
                <!-- æ¨å¥¨ãƒãƒƒã‚¸ -->
                {{if eq .Rank 1}}
                <div class="absolute -top-2.5 left-4 px-2 py-0.5 bg-green-500 text-white text-xs font-bold rounded-full">
                    æ¨å¥¨
                </div>
                {{end}}

                <!-- é‹è³ƒã‚¿ã‚¤ãƒ— -->
                <div class="text-center mb-3 pt-1">
                    <span class="text-sm font-medium {{if eq .Rank 1}}text-green-700{{else}}text-gray-600{{end}}">{{.Type}}</span>
                </div>

                <!-- é‡‘é¡ -->
                <div class="text-center">
                    <span class="text-2xl font-bold {{if eq .Rank 1}}text-green-600{{else}}text-gray-800{{end}}">&yen;{{formatNumber .Fare}}</span>
                    {{if eq .Rank 1}}
                    <div class="text-xs text-green-600 mt-1">æœ€å®‰</div>
                    {{end}}
                </div>

                <!-- é«˜é€Ÿä»£ + åˆè¨ˆï¼ˆé«˜é€Ÿä½¿ç”¨æ™‚ã®ã¿ï¼‰ -->
                {{if and $.UseHighway $.HighwayToll}}
                <div class="mt-3 pt-3 border-t {{if eq .Rank 1}}border-green-200{{else}}border-gray-200{{end}}">
                    <div class="flex justify-between text-xs {{if eq .Rank 1}}text-green-600{{else}}text-gray-500{{end}} mb-1">
                        <span>+ é«˜é€Ÿä»£ï¼ˆETCï¼‰</span>
                        <span>&yen;{{formatNumber $.HighwayToll.EtcToll}}</span>
                    </div>
                    <div class="flex justify-between items-center font-bold {{if eq .Rank 1}}text-green-700{{else}}text-gray-700{{end}}">
                        <span class="text-sm">åˆè¨ˆ</span>
                        <span class="text-lg">&yen;{{formatNumber (add .Fare $.HighwayToll.EtcToll)}}</span>
                    </div>
                </div>
                {{end}}
            </div>
            {{end}}
        </div>
    </div>

    {{if .UseHighway}}
    <!-- é«˜é€Ÿæ–™é‡‘ -->
    <div class="bg-white rounded-lg border border-gray-200 p-6">
        <h2 class="text-base font-semibold text-gray-800 mb-4">é«˜é€Ÿæ–™é‡‘</h2>
        {{if .HighwayError}}
        <div class="bg-red-50 border border-red-200 rounded-md p-4 text-sm text-red-700">
            <p>{{.HighwayError}}</p>
        </div>
        {{else if .HighwayToll}}
        <div class="space-y-4">
            <!-- åŒºé–“æƒ…å ±ï¼ˆ1è¡Œè¡¨ç¤ºï¼‰ -->
            <div class="flex flex-wrap items-center gap-x-2 gap-y-1 text-sm pb-3 border-b border-gray-200">
                <span class="font-medium text-gray-800">{{.HighwayToll.OriginIC}}</span>
                <span class="text-gray-400">â†’</span>
                <span class="font-medium text-gray-800">{{.HighwayToll.DestIC}}</span>
                <span class="text-gray-300 hidden sm:inline">|</span>
                <span class="text-gray-600">{{.HighwayToll.CarTypeName}}</span>
                <span class="text-gray-300 hidden sm:inline">|</span>
                <span class="text-gray-600">{{printf "%.1f" .HighwayToll.DistanceKm}}km</span>
                {{if gt .HighwayToll.DurationMin 0}}
                <span class="text-gray-300 hidden sm:inline">|</span>
                <span class="text-gray-600">ç´„{{formatDuration .HighwayToll.DurationMin}}</span>
                {{end}}
            </div>

            <!-- æ–™é‡‘3åŒºåˆ†ï¼ˆã‚°ãƒªãƒƒãƒ‰ï¼‰ -->
            <div class="grid grid-cols-3 gap-3 text-center">
                <!-- é€šå¸¸æ–™é‡‘ -->
                <div class="bg-gray-50 p-3 rounded-lg">
                    <div class="text-xs text-gray-500 mb-1">é€šå¸¸æ–™é‡‘</div>
                    <div class="text-lg font-bold text-gray-800">&yen;{{formatNumber .HighwayToll.NormalToll}}</div>
                </div>
                <!-- ETCæ–™é‡‘ -->
                <div class="bg-blue-50 p-3 rounded-lg">
                    <div class="text-xs text-blue-600 mb-1">ETCæ–™é‡‘</div>
                    <div class="text-lg font-bold text-blue-700">&yen;{{formatNumber .HighwayToll.EtcToll}}</div>
                    {{if gt .HighwayToll.NormalToll 0}}
                    <div class="text-xs text-blue-500 mt-1">&yen;{{formatNumber (sub .HighwayToll.NormalToll .HighwayToll.EtcToll)}}ãŠå¾—</div>
                    {{end}}
                </div>
                <!-- ETC2.0ï¼ˆæœ€å®‰ãƒãƒƒã‚¸ä»˜ãï¼‰ -->
                <div class="relative bg-green-50 p-3 rounded-lg border-2 border-green-400">
                    {{if le .HighwayToll.Etc2Toll .HighwayToll.EtcToll}}
                    <div class="absolute -top-2 left-1/2 -translate-x-1/2 px-2 py-0.5 bg-green-500 text-white text-xs font-bold rounded whitespace-nowrap">æœ€å®‰</div>
                    {{end}}
                    <div class="text-xs text-green-600 mb-1">ETC2.0</div>
                    <div class="text-lg font-bold text-green-700">&yen;{{formatNumber .HighwayToll.Etc2Toll}}</div>
                    {{if gt .HighwayToll.NormalToll 0}}
                    <div class="text-xs text-green-500 mt-1">&yen;{{formatNumber (sub .HighwayToll.NormalToll .HighwayToll.Etc2Toll)}}ãŠå¾—</div>
                    {{end}}
                </div>
            </div>

            {{if .HighwayToll.FromCache}}
            <div class="text-xs text-gray-400 text-right">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å–å¾—</div>
            {{end}}
        </div>
        {{end}}
    </div>
    {{end}}

    <!-- è©³ç´°è¡¨ç¤ºï¼ˆã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ï¼‰ -->
    <div class="bg-white rounded-lg border border-gray-200 p-6">
        <h2 class="text-base font-semibold text-gray-800 mb-4">è¨ˆç®—è©³ç´°</h2>

        {{if eq .VehicleCode 0}}
        <!-- è»½è²¨ç‰©/èµ¤å¸½ã®å ´åˆï¼šèµ¤å¸½é‹è³ƒã®ã¿è¡¨ç¤º -->

        <!-- èµ¤å¸½ï¼ˆè·é›¢åˆ¶ï¼‰ -->
        <details class="mb-4 border rounded-md overflow-hidden">
            <summary class="p-4 cursor-pointer bg-gray-50 hover:bg-gray-100 font-medium flex justify-between items-center">
                <span>èµ¤å¸½é‹è³ƒï¼ˆè·é›¢åˆ¶ï¼‰</span>
                <span class="text-gray-700">&yen;{{formatNumber .AkabouDistanceResult.TotalFare}}</span>
            </summary>
            <div class="p-4 text-sm border-t bg-white">
                <!-- åŸºæœ¬æƒ…å ± -->
                <div class="text-xs text-gray-500 mb-3 pb-2 border-b border-gray-100">
                    è·é›¢: {{.AkabouDistanceResult.DistanceKm}}km
                </div>
                <!-- æ˜ç´° -->
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <span class="text-gray-600">åŸºæœ¬æ–™é‡‘ï¼ˆ20kmä»¥å†…ï¼‰</span>
                        <span class="font-medium">&yen;{{formatNumber .AkabouDistanceResult.BaseFare}}</span>
                    </div>
                    {{if gt .AkabouDistanceResult.DistanceCharge 0}}
                    <div class="flex justify-between">
                        <span class="text-gray-600">è·é›¢åŠ ç®—</span>
                        <span class="font-medium">+&yen;{{formatNumber .AkabouDistanceResult.DistanceCharge}}</span>
                    </div>
                    {{end}}
                    {{if gt .AkabouDistanceResult.AreaSurcharge 0}}
                    <div class="flex justify-between text-blue-600">
                        <span class="flex items-center gap-1">
                            <span>åœ°åŒºå‰²å¢—</span>
                            <span class="px-1.5 py-0.5 bg-blue-100 text-blue-700 text-xs rounded">{{.AkabouDistanceResult.Area}}</span>
                        </span>
                        <span class="font-medium">+&yen;{{formatNumber .AkabouDistanceResult.AreaSurcharge}}</span>
                    </div>
                    {{end}}
                    {{if .AkabouDistanceResult.IsNight}}
                    <div class="flex justify-between text-purple-600">
                        <span class="flex items-center gap-1">
                            <span>æ·±å¤œå‰²å¢—</span>
                            <span class="px-1.5 py-0.5 bg-purple-100 text-purple-700 text-xs rounded">+30%</span>
                        </span>
                        <span class="font-medium">+&yen;{{formatNumber .AkabouDistanceResult.NightSurcharge}}</span>
                    </div>
                    {{end}}
                    {{if .AkabouDistanceResult.IsHoliday}}
                    <div class="flex justify-between text-orange-600">
                        <span class="flex items-center gap-1">
                            <span>ä¼‘æ—¥å‰²å¢—</span>
                            <span class="px-1.5 py-0.5 bg-orange-100 text-orange-700 text-xs rounded">+20%</span>
                        </span>
                        <span class="font-medium">+&yen;{{formatNumber .AkabouDistanceResult.HolidaySurcharge}}</span>
                    </div>
                    {{end}}
                </div>
                <!-- åˆè¨ˆ -->
                <div class="flex justify-between mt-3 pt-3 border-t border-gray-200 font-bold text-gray-900 bg-gray-50 -mx-4 px-4 py-2 -mb-4">
                    <span>åˆè¨ˆ</span>
                    <span>&yen;{{formatNumber .AkabouDistanceResult.TotalFare}}</span>
                </div>
            </div>
        </details>

        <!-- èµ¤å¸½ï¼ˆæ™‚é–“åˆ¶ï¼‰ -->
        <details class="border rounded-md overflow-hidden">
            <summary class="p-4 cursor-pointer bg-gray-50 hover:bg-gray-100 font-medium flex justify-between items-center">
                <span>èµ¤å¸½é‹è³ƒï¼ˆæ™‚é–“åˆ¶ï¼‰</span>
                <span class="text-gray-700">&yen;{{formatNumber .AkabouTimeResult.TotalFare}}</span>
            </summary>
            <div class="p-4 text-sm border-t bg-white">
                <!-- åŸºæœ¬æƒ…å ± -->
                <div class="text-xs text-gray-500 mb-3 pb-2 border-b border-gray-100">
                    ä½œæ¥­æ™‚é–“: {{.AkabouTimeResult.DurationMin}}åˆ†ï¼ˆ{{formatDuration .AkabouTimeResult.DurationMin}}ï¼‰
                </div>
                <!-- æ˜ç´° -->
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <span class="text-gray-600">åŸºæœ¬æ–™é‡‘ï¼ˆ2æ™‚é–“ã¾ã§ï¼‰</span>
                        <span class="font-medium">&yen;{{formatNumber .AkabouTimeResult.BaseFare}}</span>
                    </div>
                    {{if gt .AkabouTimeResult.OvertimeCharge 0}}
                    <div class="flex justify-between">
                        <span class="text-gray-600">è¶…éæ–™é‡‘ï¼ˆ{{.AkabouTimeResult.OvertimeMin}}åˆ†è¶…éï¼‰</span>
                        <span class="font-medium">+&yen;{{formatNumber .AkabouTimeResult.OvertimeCharge}}</span>
                    </div>
                    {{end}}
                    {{if gt .AkabouTimeResult.AreaSurcharge 0}}
                    <div class="flex justify-between text-blue-600">
                        <span class="flex items-center gap-1">
                            <span>åœ°åŒºå‰²å¢—</span>
                            <span class="px-1.5 py-0.5 bg-blue-100 text-blue-700 text-xs rounded">{{.AkabouTimeResult.Area}}</span>
                        </span>
                        <span class="font-medium">+&yen;{{formatNumber .AkabouTimeResult.AreaSurcharge}}</span>
                    </div>
                    {{end}}
                    {{if .AkabouTimeResult.IsNight}}
                    <div class="flex justify-between text-purple-600">
                        <span class="flex items-center gap-1">
                            <span>æ·±å¤œå‰²å¢—</span>
                            <span class="px-1.5 py-0.5 bg-purple-100 text-purple-700 text-xs rounded">+30%</span>
                        </span>
                        <span class="font-medium">+&yen;{{formatNumber .AkabouTimeResult.NightSurcharge}}</span>
                    </div>
                    {{end}}
                    {{if .AkabouTimeResult.IsHoliday}}
                    <div class="flex justify-between text-orange-600">
                        <span class="flex items-center gap-1">
                            <span>ä¼‘æ—¥å‰²å¢—</span>
                            <span class="px-1.5 py-0.5 bg-orange-100 text-orange-700 text-xs rounded">+20%</span>
                        </span>
                        <span class="font-medium">+&yen;{{formatNumber .AkabouTimeResult.HolidaySurcharge}}</span>
                    </div>
                    {{end}}
                </div>
                <!-- åˆè¨ˆ -->
                <div class="flex justify-between mt-3 pt-3 border-t border-gray-200 font-bold text-gray-900 bg-gray-50 -mx-4 px-4 py-2 -mb-4">
                    <span>åˆè¨ˆ</span>
                    <span>&yen;{{formatNumber .AkabouTimeResult.TotalFare}}</span>
                </div>
            </div>
        </details>

        {{else}}
        <!-- 2tä»¥ä¸Šã®å ´åˆï¼šãƒˆãƒ©å”é‹è³ƒã®ã¿è¡¨ç¤º -->

        <!-- è·é›¢åˆ¶é‹è³ƒ -->
        <details class="mb-4 border rounded-md overflow-hidden">
            <summary class="p-4 cursor-pointer bg-gray-50 hover:bg-gray-100 font-medium flex justify-between items-center">
                <span>è·é›¢åˆ¶é‹è³ƒï¼ˆãƒˆãƒ©å”åŸºæº–ï¼‰</span>
                <span class="text-gray-700">&yen;{{formatNumber .DistanceFareResult.TotalFare}}</span>
            </summary>
            <div class="p-4 text-sm border-t bg-white">
                <!-- åŸºæœ¬æƒ…å ± -->
                <div class="text-xs text-gray-500 mb-3 pb-2 border-b border-gray-100 flex flex-wrap gap-x-4 gap-y-1">
                    <span>{{regionName .DistanceFareResult.RegionCode}}</span>
                    <span>{{vehicleName .DistanceFareResult.VehicleCode}}</span>
                    <span>{{.DistanceFareResult.DistanceKm}}km â†’ {{.DistanceFareResult.RoundedKm}}km</span>
                </div>
                <!-- æ˜ç´° -->
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <span class="text-gray-600">åŸºæœ¬é‹è³ƒ</span>
                        <span class="font-medium">&yen;{{formatNumber .DistanceFareResult.BaseFare}}</span>
                    </div>
                    {{if .DistanceFareResult.IsNight}}
                    <div class="flex justify-between text-purple-600">
                        <span class="flex items-center gap-1">
                            <span>æ·±å¤œå‰²å¢—</span>
                            <span class="px-1.5 py-0.5 bg-purple-100 text-purple-700 text-xs rounded">+30%</span>
                        </span>
                        <span class="font-medium">+&yen;{{formatNumber .DistanceFareResult.NightSurcharge}}</span>
                    </div>
                    {{end}}
                    {{if .DistanceFareResult.IsHoliday}}
                    <div class="flex justify-between text-orange-600">
                        <span class="flex items-center gap-1">
                            <span>ä¼‘æ—¥å‰²å¢—</span>
                            <span class="px-1.5 py-0.5 bg-orange-100 text-orange-700 text-xs rounded">+20%</span>
                        </span>
                        <span class="font-medium">+&yen;{{formatNumber .DistanceFareResult.HolidaySurcharge}}</span>
                    </div>
                    {{end}}
                </div>
                <!-- åˆè¨ˆ -->
                <div class="flex justify-between mt-3 pt-3 border-t border-gray-200 font-bold text-gray-900 bg-gray-50 -mx-4 px-4 py-2 -mb-4">
                    <span>åˆè¨ˆ</span>
                    <span>&yen;{{formatNumber .DistanceFareResult.TotalFare}}</span>
                </div>
            </div>
        </details>

        <!-- æ™‚é–“åˆ¶é‹è³ƒ -->
        <details class="border rounded-md overflow-hidden">
            <summary class="p-4 cursor-pointer bg-gray-50 hover:bg-gray-100 font-medium flex justify-between items-center">
                <span>æ™‚é–“åˆ¶é‹è³ƒï¼ˆãƒˆãƒ©å”åŸºæº–ï¼‰</span>
                <span class="text-gray-700">&yen;{{formatNumber .TimeFareResult.TotalFare}}</span>
            </summary>
            <div class="p-4 text-sm border-t bg-white">
                <!-- åŸºæœ¬æƒ…å ± -->
                <div class="text-xs text-gray-500 mb-3 pb-2 border-b border-gray-100 flex flex-wrap gap-x-4 gap-y-1">
                    <span>{{regionName .TimeFareResult.RegionCode}}</span>
                    <span>{{vehicleName .TimeFareResult.VehicleCode}}</span>
                    <span>{{.TimeFareResult.AppliedHours}}æ™‚é–“åˆ¶</span>
                </div>
                <div class="text-xs text-gray-500 mb-3 pb-2 border-b border-gray-100 flex flex-wrap gap-x-4 gap-y-1">
                    <span>èµ°è¡Œ: {{.TimeFareResult.DistanceKm}}kmï¼ˆåŸºç¤: {{.TimeFareResult.BaseKm}}kmï¼‰</span>
                    <span>æ‹˜æŸ: {{formatDuration .TimeFareResult.TotalMinutes}}</span>
                </div>
                <!-- æ˜ç´° -->
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <span class="text-gray-600">åŸºç¤é‹è³ƒ</span>
                        <span class="font-medium">&yen;{{formatNumber .TimeFareResult.BaseFare}}</span>
                    </div>
                    {{if gt .TimeFareResult.DistanceSurcharge 0}}
                    <div class="flex justify-between">
                        <span class="text-gray-600">è·é›¢åŠ ç®—ï¼ˆè¶…é{{.TimeFareResult.ExcessKm}}kmï¼‰</span>
                        <span class="font-medium">+&yen;{{formatNumber .TimeFareResult.DistanceSurcharge}}</span>
                    </div>
                    {{end}}
                    {{if gt .TimeFareResult.TimeSurcharge 0}}
                    <div class="flex justify-between">
                        <span class="text-gray-600">æ™‚é–“åŠ ç®—ï¼ˆè¶…é{{.TimeFareResult.ExcessMinutes}}åˆ†ï¼‰</span>
                        <span class="font-medium">+&yen;{{formatNumber .TimeFareResult.TimeSurcharge}}</span>
                    </div>
                    {{end}}
                    {{if .TimeFareResult.IsNight}}
                    <div class="flex justify-between text-purple-600">
                        <span class="flex items-center gap-1">
                            <span>æ·±å¤œå‰²å¢—</span>
                            <span class="px-1.5 py-0.5 bg-purple-100 text-purple-700 text-xs rounded">+30%</span>
                        </span>
                        <span class="font-medium">+&yen;{{formatNumber .TimeFareResult.NightSurcharge}}</span>
                    </div>
                    {{end}}
                    {{if .TimeFareResult.IsHoliday}}
                    <div class="flex justify-between text-orange-600">
                        <span class="flex items-center gap-1">
                            <span>ä¼‘æ—¥å‰²å¢—</span>
                            <span class="px-1.5 py-0.5 bg-orange-100 text-orange-700 text-xs rounded">+20%</span>
                        </span>
                        <span class="font-medium">+&yen;{{formatNumber .TimeFareResult.HolidaySurcharge}}</span>
                    </div>
                    {{end}}
                </div>
                <!-- åˆè¨ˆ -->
                <div class="flex justify-between mt-3 pt-3 border-t border-gray-200 font-bold text-gray-900 bg-gray-50 -mx-4 px-4 py-2 -mb-4">
                    <span>åˆè¨ˆ</span>
                    <span>&yen;{{formatNumber .TimeFareResult.TotalFare}}</span>
                </div>
            </div>
        </details>

        {{end}}
    </div>

</div>
{{end}}

{{define "error"}}
<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md">
    <p class="font-medium">ã‚¨ãƒ©ãƒ¼</p>
    <p>{{.Error}}</p>
</div>
{{end}}
